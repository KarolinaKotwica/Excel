<!DOCTYPE html>
<html lang="pl">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1 user-scalable='no'">
        <meta name="description" content="Excelwpracy.pl - strona główna, ciekawostki ze świata Excela, pomoc, zlecenia, porady">
        <meta name="keywords" content="excel, excel praca, excel w pracy, vba, excel vba, excel wykresy, excel funkcje, excel formularze, excel online, microsoft excel, excel kurs, excel samouczek, excel podstawy">
        <title>VBA PowerPoint</title>

        <link rel="stylesheet" href="less/style.css">
        <link href="https://fonts.googleapis.com/css?family=Sorts+Mill+Goudy" rel="stylesheet">
        <link href="fonts/cour.ttf" rel="stylesheet">

        <!--[if lt IE 9]>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
<!--[endif]-->

    </head>

    <body>

        <div class="wrapper">
            <!---------------------- NAVIGATION MENU ---------------------------------->
            <div class="sidebar">
                <input class="menu-btn" type="checkbox" id="menu-btn">
                <label class="menu-icon" for="menu-btn"><span class="navicon"></span></label>

                <div class="wrapper-nav" id="menu">
                    <a href="index.html" class="home">Strona główna</a>
                    <p class="name-nav">EXCEL</p>
                    <ul class="nav">
                        <li><a href="wykresy.html">Wykresy</a></li>
                        <li><a href="funkcje.html">Funkcje</a></li>
                    </ul>


                    <p class="name-nav">VBA</p>
                    <ul class="nav">
                        <li><a href="excel.html">Excel</a></li>
                        <li><a href="userforms.html">Formularze</a></li>
                        <li><a href="ribbon.html">Ribbon/Context Menu</a></li>
                        <li><a href="outlook.html">Outlook</a></li>
                        <li><a href="powerpoint.html">PowerPoint</a></li>
                        <li><a href="access.html">Access</a></li>
                        <li><a href="word.html">Word</a></li>
                        <li><a href="internet_explorer.html">Internet Explorer</a></li>
                        <li><a href="sap.html">SAP</a></li>
                        <li><a href="scriptingdictionary.html">Scripting.Dictionary</a></li>
                    </ul>

                    <!---------------------- Contact ---------------------->

                    <p class="contact">
                        W razie pytań lub zlecenia pracy, zapraszam do kontaktu:
                        <span class="email"><a href="mailto:rafal@exelwpracy.pl?Subject=Hello%20again" target="_top">rafal@excelwpracy.pl</a></span>
                    </p>

                </div>
            </div>

            <!--------------------------------- CONTEXT ---------------------------------->

            <div class="main" id="demo">

                <!-----------TEMATY -------------------->

                <div class="topics">

                    <div class="left-text">
                        <h1>PowerPoint</h1>
                        <p>Excel, Offce, powerPoint,<br>
                            To nie czas na innerJoint.<br>
                            Jak otworzyć prezentację?<br>
                            Zrobić małe akrobacje?<br>
                            Nie ma co się tu rozwijać,<br>
                            Nie ma po co się obijać.<br>
                            Prosta pętla poprzez slajdy,<br>
                            Może dać Ci trochę frajdy.<br>
                            Znowu pętla, lecz przez kształty,<br>
                            Można robić na nich gwałty.<br>
                            Kopiuj wykres, zamień tekst,<br>
                            Wiele więcej + kontekst.<br>
                            Dodawałem komentarze,<br>
                            Więcej treści w nich przekażę.<br>
                        </p>
                    </div>

                    <div class="right-image"><img src="img/referencje_PPT.PNG" alt="PowerPoint referencje"></div>
                </div>
                <br>
                <div class="grey-field">
                    <p class="board">Dim pepet As PowerPoint.Application<br>Dim curslide As PowerPoint.Slide<br>Dim xchart As Excel.ChartObject<br>Dim Hrrrep As PowerPoint.Application<br><br><br>Set pepet = New PowerPoint.Application<br><br>pepet.Visible = True<br><br>Filename = Application.ThisWorkbook.Path &amp; "\HR_report012016_sampleforMacroFile.pptx"<br><br>pepet.Presentations.Open Filename, False, False, True <span class="green">'tak otwieram prezentację</span><br><br></p>
                </div>
                <br><br>

                <div class="grey-field">
                    <p class="board">Wb.Sheets(1).ChartObjects("Slajd4").Activate <span class="green">'wb to Workbook, który wcześniej zostal zdefiniowany<br>' dobrze jest najpierw zaznaczyć wykres (.activate), a dopiero potem dopiero kopiować</span><br>Wb.Sheets(1).ChartObjects("Slajd4").Copy<br><br><br>pepet.ActivePresentation.Slides(4).Shapes.Paste  <span class="green">‘’ wklejam wykres</span><br></p>
                </div>
                <br><br>

                <div class="grey-field">
                    <p class="board">If Month(Now() - 1) = 0 Then <span class="green">‘' ustalam rok I miesią, który był miesiąc temu</span><br>miesiac = MonthName(12) <span class="green">' styczeń – 1 = 0, dlatego trzeba to sprawdzić</span><br>rok = Year(Now() - 1)<br>Else<br>miesiac = MonthName(Month(Now()) - 1)<br>rok = Year(Now())<br>End If<br><br>Pepet.Activepresentation.Slides(1).Shapes("Subtitle 2").TextFrame.TextRange.Text = miesiac &amp; " " &amp; rok  <span class="green">'wpisuję dzień I rok do podtytułu slajdu</span><br>currentSlajd = getSlideNumber("Tytuł slajdu")<br>pepet.ActivePresentation.Slides(currentSlajd).Select<br>pepet.ActivePresentation.Slides(currentSlajd).Copy<br>pepet.ActivePresentation.Application.CommandBars.ExecuteMso ("PasteSourceFormatting")  <span class="green">'kopiuję slajd I wklejam pod spodem</span><br></p>
                </div>
                <br><br>
                
                <div class="grey-field">
                    <p class="board">Worksheets("Pivot68").Range("A38:" &amp; Cells(lastrow, lastcolumn).Address).Copy   <span class="green">'kopiuję interensujący mnie fragment arkusz</span><br>pepet.ActivePresentation.Slides(currentSlajd + 1).Shapes.PasteSpecial ppPasteEnhancedMetafile <span class="green">'’wklejam do prezentacji, po czym ustawiam jego pozycję (wiem, że jest tylko tytuł, więc biorę 2gi kształt)</span><br><br><br>pepet.ActivePresentation.Slides(currentSlajd + 1).Shapes(2).Top = 111.2881<br>pepet.ActivePresentation.Slides(currentSlajd + 1).Shapes(2).Left = 19.75008<br></p>
                </div>
                <br><br>
                
                <div class="grey-field">
                    <p class="board">pepet.ActivePresentation.SaveAs Filename:=pdfname, FileFormat:=ppSaveAsPDF <span class="green">' export prezentacji do PDF</span></p>
                </div>
                <br><br>
                
                <div class="grey-field">
                    <p class="board">Set oPres = Presentations.Open(Path &amp; file)<br><br>With oPres<br><span class="green">   ' każdy slajd na prezentacji</span><br>   For Each oSld In .Slides<br>   Debug.Print oSld.SlideNumber<br>     Call SetLinksToManual(oSld)<br>   Next<br>   .Save<br>   .Close<br><br><br>End With<br>Set oPres = Nothing<br><br><br>Sub SetLinksToManual(oSld As Object)<br>   Dim oShp As PowerPoint.Shape<br>   For Each oShp In oSld.Shapes<br>     If oShp.Type = msoLinkedOLEObject Then<br><span class="green">     'zmiana na manualupdate</span><br>       oShp.LinkFormat.AutoUpdate = ppUpdateOptionManual<br>     End If<br>   Next oShp<br>End Sub<br><br>Sub SetLinksToAutomatic(oSld As Object)<br>   Dim oShp As PowerPoint.Shape<br>   For Each oShp In oSld.Shapes<br>     If oShp.Type = msoLinkedOLEObject Then<br><span class="green">     'zmiana łączy na autoupdate</span><br>       oShp.LinkFormat.AutoUpdate = ppUpdateOptionAutomatic<br>     End If<br>   Next oShp<br>End Sub<br><br><br><br>Sub updateslide(oSld As Object)<br>   Dim oShp As PowerPoint.Shape<br>   For Each oShp In oSld.Shapes<br>     If oShp.Type = msoLinkedOLEObject Then<br><span class="green">     'aktualizuje łącza do slajdów</span><br>       oShp.LinkFormat.Update<br>     End If<br>   Next oShp<br>End Sub<br><br>Sub breakslide(oSld As Object)<br>   Dim oShp As PowerPoint.Shape<br>   For Each oShp In oSld.Shapes<br>     If oShp.Type = msoLinkedOLEObject Then<br><span class="green">     'zrywa łącza</span><br>       oShp.LinkFormat.BreakLink<br>     End If<br>   Next oShp<br>End Sub<br></p>
                </div>
                <br><br>
                
                <div class="grey-field">
                    <p class="board"><span class="green">''' na koniec procudury usuwajacej łącza wstawiam takie coś, żebym potem wiedział kto mi psuje linki</span><br>    On Error Resume Next<br>     var = oPres.CustomDocumentProperties("Break").Value<br>     If Err.Number > 0 Then<br>oPres.CustomDocumentProperties.Add Name:="Break", LinkToContent:=False, Type:=msoPropertyTypeString, Value:=VBA.Environ("username") <span class="green">''nazwa użytkownika trafia do metafile data</span><br>     End If<br>     Err.Clear<br><br>Set oPres = Nothing<br></p>
                </div>

                <br><br>
            </div>
        </div>



        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src=" http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>

        <script src="js/script.js"></script>


    </body>

</html>
